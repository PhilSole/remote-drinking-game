// ==================================================================
//
//  This module names some global stuff then kicks off the app
//
// ==================================================================

// Global variable to namespace modules
let codrink19 = {};

// Global DOM variables
let $body;

// Global objects
let socket;

$(document).ready(function() {

    // Assign global DOM variables
    $body = $('body');

    // Initialise modules
    codrink19.connection.init();
    codrink19.startGame.init();
});
// ==================================================================
//
//  This module handles the player connections to the game
//
// ==================================================================
codrink19.connection = function() {
    
    let init = function() {
        console.log('This client initiated a new socket connection');

        // Initialise socket.io-client
        socket = io();

        // Check if this is just a reconnection or a new connection
        let playerID = localStorage.getItem('playerID');
        socket.emit('credentials', playerID);

        // Handle if this is a new client
        socket.on('new client', function(playerid){
            console.log('this is a new player so set ID to: ' + playerid);
            localStorage.setItem('playerID', playerid);
        });



        // Handle another new player joining
        socket.on('hi', function(msg){
            alert('a new player has connected');
        });

        // Emit a test event with value
        socket.emit('test', 'my value');    
        
    }

    return {
        init: init
    } 
}();

// ===============================================================================
//
//  Code snippets
//
// ===============================================================================

        // Handle form submission
        // $('form').submit(function(e){
        //     e.preventDefault(); // prevents page reloading
        //     socket.emit('chat message', $('#m').val());
        //     $('#m').val('');
        //     return false;
        // });

        // Handle the 'chat message' event
        // socket.on('chat message out', function(msg){
        //     $('#messages').append($('<li>').text(msg));
        // });
// ==================================================================
//
//  This module handles a game being created
//
// ==================================================================
codrink19.startGame = function() {

    let $buttonStart;
    
    let init = function() {
        $buttonStart = $body.find('.button-start');

        $buttonStart.on('click', function() {

            let roomID = socket.id;

            console.log(location.host);

            let gameURL = location.host + '/?room=' + socket.id;

            console.log(gameURL);

        });
        
    }

    return {
        init: init
    } 
}();
// ==================================================================
//
//  This module handles the waiting room logic
//
// ==================================================================
codrink19.waitingRoom = function() {

    let $form;
    
    let init = function() {
        $form = $body.find('form.form');

        
    }

    return {
        init: init
    } 
}();